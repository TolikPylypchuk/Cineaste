@page "/"
@inherits ReactiveInjectableComponentBase<HomePageViewModel>
@inject IStringLocalizer<Resources> Loc

<div class="container d-flex flex-column align-items-center">
    <h1 class="display-1 mt-md-2 mt-1">@this.Loc["Cineaste"]</h1>

    <h2 class="display-5 mt-2">@this.Loc["HomePage.MyLists"]</h2>

    <RadzenButton Text="@this.Loc["HomePage.CreateList"]" Icon="add_circle_outline" ButtonStyle="ButtonStyle.Primary"
                  Click=@(() => this.ViewModel!.NavigateToCreateList()) class="mt-4" />

    <RemoteContent ViewModel="this.ViewModel!.GetListsCall">
        <Loading>
            <RadzenProgressBar Value="100" ShowValue="false" Mode="ProgressBarMode.Indeterminate" class="w-25 mt-4" />
        </Loading>

        <Content>
            <RadzenDataList WrapItems="true" Data="this.ViewModel!.Lists" TItem="SimpleListModel" class="mt-4">
                <Template Context="list">
                    <div role="button" class="container border-bottom" style="border: none; border-radius: 0;"
                         @ondblclick=@(() => this.ViewModel!.NavigateToList(list))>
                        <div class="row">
                            <p class="lead m-1">@list.Name</p>
                        </div>
                    </div>
                </Template>
            </RadzenDataList>
        </Content>

        <Problem Context="problem">
            <ApiProblemAlert Text="Loading lists has failed" TryAgain="this.ViewModel!.LoadLists" Class="w-50 mt-3" />
        </Problem>
    </RemoteContent>
</div>

@code {
    protected override async Task OnParametersSetAsync()
    {
        await base.OnParametersSetAsync();
        await this.ViewModel!.LoadLists();
    }
}
